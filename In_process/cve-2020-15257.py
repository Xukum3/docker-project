#!/bin/python3

import os
import stat

def cve_2020_15271():
    print("CVE 2020-15257 check\n")
    print("Check for abstract socker")
    try:
        found = False
        socketfile = open('/proc/net/unix')
        for line in socketfile.readlines():
            if line.find('@/containerd') >= 0:
                print("Abstract socket was found.\nHost may be vulnerable")
                found = True
                break
        if not(found):
            print('Host seems to be invulnerable for CVE 2020-15257')

    except:
        print("Error while opening /proc/net/unix")

if __name__ == "__main__":
    cve_2020_15271()
